---
layout:     post
title:      copy 和 mutableCopy
subtitle:   
date:       2017-11-15
author:     hdj
header-img: img/bgs/XCode-bg.jpg
catalog: true
tags:
    - iOS
    - copy 和 mutableCopy
---

鸟巢实施说明书























北京鑫丰南格科技有限责任公司
                                目录
前言	4
1.安装Ubuntu-Server	5
1.1准备工做	5
1.2开始安装	5
1.3安装系统及应用所需的基本内容	5
安装JDK	7
2.1 下载安装	7
2.2 上传安装	7
2.3 验证	7
3.安装NEO4J	8
3.1下载或上传	8
3.2 解压	8
3.2安装与配置	8
4.安装MongoDB	10
4.1 下载或上传	10
4.2 解压	10
4.4 验证	13
5.安装Redis	14
5.1下载或上传	14
5.2 解压	14
5.4 验证	15
6.安装Apollo	16
6.1下载或上传	16
6.2 解压	16
6.4 验证	18
7.安装OpenSips	19
7.2安装依赖	19
7.2下载	19
7.3解压	19
7.4 验证	21
8.安装Nginx	22
8.1下载	22
8.2解压	22
8.4 验证	23
9安装NodeJs	24
9.1使用nvm安装nodejs	24
9.2使用为nodejs安装cnpm命令	24
9.2安装forever	24
10部署应用	25
10.1准备工作	25
10.2 Birdnest	25
10.3 Garuda	25
10.4 Wechat	26
11服务号运维	27
11.1配置企业号	27
11.2配置服务号	36
附件	41
附件1. Nginx配置文件	41
附件2. Windows下使用Xftp5上传	43
附件3. Linux下使用scp命令上传	46
附件4. Systemd服务相关操作	47
附件5. vi和vim命令的使用	48
前言1.安装Ubuntu-Server
1.1准备工做
MINI PC , 安装有Ubuntu-server版的U盘安装
1.2开始安装
点击打开Ubuntu-Server安装文档
1.3安装系统及应用所需的基本内容
修改在本机的命令行中文乱码的问题，vi或者vim命令的操作请查看附件5
切换root ：
su root
执行命令：
vi /etc/default/locale
编辑其中内容，修改为如下：
# File generated by update-locale
LANG="en_US.UTF-8"
LANGUAGE="en_US:en"
修改完成后退出vi编辑器按ESC建输入
:wq
退出登录，并从新登录：
exit
设置root密码，并开启root远程访问，vi或者vim命令的操作请查看附件5
设置root密码：
passwd
开启ssh root用户远程访问：
vi /etc/ssh/sshd_config
注释掉 #PermitRootLogin without-password，添加 PermitRootLogin yes如下：
# Authentication:
LoginGraceTime 120
#PermitRootLogin without-password
PermitRootLogin yes
StrictModes yes
重启ssh执行：
systemctl restart sshd
安装RXTX类库
apt-get install librxtx-java
将一下文件放进环境变量中
cp /usr/lib/jni/librxtxParallel.so /lib64/librxtxParallel.so
cp /usr/lib/jni/librxtxSerial.so /lib64/librxtxSerial.so

创建应用所需文件夹
soft文件夹是安装数据库和中间件的地方
mkdir /soft/
download文件夹是存放所有上传的文件以及下载的文件的地方
su nangle
mkdir ~/download/
安装VIM编辑器
su root
apt-get install vim
安装JDK
2.1 下载安装
为APT仓库添加PPA
add-apt-repository ppa:webupd8team/java
apt-get update
开始安装
sudo apt-get install oracle-java8-installer make gcc g++

在这一步的安装过程中有10~20分钟的下载时间，这部分时间可以准备一下无线接收器，并且测试是否运行正常。
2.2 上传安装
上传 - 上传jdk到download目录
在文档附带的package（Ctrl + 鼠标左键）目录中寻找jdk1.8.0-121_1.8.0121-1_amd64.deb
linux命令scp上传 - 请参见附件3 Ctrl + 鼠标左键进入超链接
windows上传 - 请参见附件2 Ctrl + 鼠标左键进入超链接
不管使用什么方式上传请将文件上传到~/download/目录
如果使用jdk1.8.0-121_1.8.0121-1_amd64.deb安装请配置环境变量
tar -xf jdk-8u131-linux-x64.tar.gz -C /soft/
export JAVA_HOME=/usr/java/jdk1.8.0_131
export PATH=$JAVA_HOME/bin:$PATH
export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
source /etc/profile
2.3 验证
java --version
3.安装NEO4J
3.1下载或上传
下载 - 在下载之前要先进入到download，使用wget命令下载neo4j社区版
cd ~/download/
wget https://neo4j.com/artifact.php?name=neo4j-community-3.2.1-unix.tar.gz -O neo4j-community-3.2.1-unix.tar.gz
上传 - 上传neo4j到download目录
在文档附带的package（Ctrl + 鼠标左键）目录中寻找neo4j-community-3.2.1-unix.tar.gz
linux命令scp上传 - 请参见附件3 Ctrl + 鼠标左键进入超链接
windows上传 - 请参见附件2 Ctrl + 鼠标左键进入超链接
不管使用什么方式上传请将文件上传到~/download/目录
3.2 解压
使用tar命令对neo4j-community-3.2.1-unix.tar.gz文件进行解压，解压到根目录soft文件夹
tar -xf neo4j-community-3.2.1-unix.tar.gz -C /soft/
3.2安装与配置
编写systemd配置文件 - 请查看附件4 Systemd操作，vi或者vim命令的操作请查看附件5
在/etc/systemd/system/文件夹创建neo4j.service文件，并将下面红色内容复制到文件中。
[Unit]
Description=Neo4j Service
After=network.target

[Service]
Type=forking
ExecStart=/soft/neo4j-community-3.2.1/bin/neo4j start
ExecReload=/soft/neo4j-community-3.2.1/bin/neo4j restart
ExecStop=/soft/neo4j-community-3.2.1/bin/neo4j stop
RestartSec=10

[Install]
WantedBy=multi-user.target
使用systemctl对neo4j服务进行设置
加载新编写的配置文件
sudo systemctl daemon-reload
将neo4j服务设为开机启动
sudo systemctl enable neo4j.service
启动neo4j服务
sudo systemctl start neo4j.service
查看服务状态
systemctl status neo4j.service
4.安装MongoDB
4.1 下载或上传
下载 - 进入到download文件夹，使用wget命令从官网下载MongoDB社区版
cd ~/download/
wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-ubuntu1604-3.4.4.tgz
上传 - 上传mongodb到download目录
在文档附带的package（Ctrl + 鼠标左键）目录中寻找mongodb-linux-x86_64-ubuntu1604-3.4.4.tgz
linux命令scp上传 - 请参见附件3 Ctrl + 鼠标左键进入超链接
windows上传 - 请参见附件2 Ctrl + 鼠标左键进入超链接
不管使用什么方式上传请将文件上传到~/download/目录

4.2 解压
使用tar命令对mongodb-linux-x86_64-ubuntu1604-3.4.4.tgz文件进行解压，解压到根目录soft文件夹
sudo tar -xf mongodb-linux-x86_64-ubuntu1604-3.4.4.tgz -C /soft/ 4.3配置
创建文件夹
cd mongodb-linux-x86_64-ubuntu1604-3.4.4/
sudo mkdir conf db log
书写配置文件
sudo vim conf/mongod.conf
进入到vim的编辑界面输入i进入到编辑状态

使用vim命令创建mongod.conf文件将下面红色内容复制到其中输入:wq保存退出







processManagement:
   fork: true
net:
   bindIp: 0.0.0.0
   port: 27117
storage:
   dbPath: /soft/mongodb-linux-x86_64-ubuntu1604-3.4.4/db
systemLog:
   destination: file
   path: "/soft/mongodb-linux-x86_64-ubuntu1604-3.4.4/log/mongod.log"
   logAppend: true
storage:
   journal:
      enabled: true
#security:
#   authorization: enabled

编写systemd配置文件 - 请查看附件4 Systemd操作 Ctrl + 鼠标左键进入超链接
在/etc/systemd/system/文件夹创建mongod.service文件，并将下面红色内容复制到文件中。
[Unit]
Description=MongoDB Service
After=network.target

[Service]
Type=forking
ExecStart=/soft/mongodb-linux-x86_64-ubuntu1604-3.4.4/bin/mongod --config /soft/mongodb-linux-x86_64-ubuntu1604-3.4.4/conf/mongod.conf
RestartSec=10

[Install]
WantedBy=multi-user.target

使用systemctl对neo4j服务进行设置
加载新编写的配置文件
sudo systemctl daemon-reload
将neo4j服务设为开机启动
sudo systemctl enable mongod.service
启动neo4j服务
sudo systemctl start mongod.service
查看服务状态
systemctl status mongod.service

连接到本地数据库，如果您是远程链接请查看服务器对应的ip
./bin/mongo localhost:27117

使用如下命令创建mongodb数据库及数据库管理员，下面的user和pwd按照实际情况设置
use admin
db.createUser(
  {
    user: "admin",
    pwd: "admin",
    roles: [ { role: "userAdminAnyDatabase", db: "admin" } ]
  }
)
use birdnest
db.createUser(
  {
user: "yjh",
    pwd: "yjh123456790",
    roles: [ { role: "readWrite", db: "birdnest" } ]
  }
)

修改配置文件开启权限管理，并重启mongod服务
首先要进入到mongodb的conf文件夹使用vim打开文件，vi或者vim命令的操作请查看附件5
vim conf/mongod.conf

去掉最后两行的#号注释保存退出，重启mongod服务
systemctl restart mongod.service

4.4 验证
使用mongo命令进去数据库
./bin/mongo localhost:27117
先使用use命令选择birdnest数据库，使用db.auth()登录，如果返回1则表示登录成功
use birdnest
db.auth("yjh","yjh123456790");

至此MongoDB数据库就安装成功了
5.安装Redis
5.1下载或上传
下载 - 进入到download文件夹，使用wget命令从官网下载MongoDB社区版
cd ~/download/
wget http://download.redis.io/releases/redis-3.2.9.tar.gz
上传 - 上传redis到download目录
在文档附带的package（Ctrl + 鼠标左键）目录中寻找redis-3.2.9.tar.gz
linux命令scp上传 - 请参见附件3 Ctrl + 鼠标左键进入超链接
windows上传 - 请参见附件2 Ctrl + 鼠标左键进入超链接
不管使用什么方式上传请将文件上传到~/download/目录

5.2 解压
使用tar命令对redis-3.2.9.tar.gz文件进行解压，解压到根目录soft文件夹
sudo tar -xf redis-3.2.9.tar.gz -C /soft/ 5.3安装
编译，进入redis文件夹使用make命令编译源码
sudo make

安装，使用make install将redis安装到系统
sudo make install

5.3配置
设置redis.conf密码，vi或者vim命令的操作请查看附件5
vim redis.conf
根据需要设置指定密码
# requirepass foobared
requirepass 111111

编写systemd配置文件 - 请查看附件4 Systemd操作 Ctrl + 鼠标左键进入超链接
在/etc/systemd/system/文件夹创建redis.service文件，并将下面红色内容复制到文件中。
[Unit]
Description=Redis Service
After=network.target

[Service]
#Type=forking
ExecStart=/usr/local/bin/redis-server /soft/redis-3.2.9/redis.conf
ExecStop=/usr/local/bin/redis-cli shutdown
RestartSec=10

[Install]
WantedBy=multi-user.target

使用systemctl对redis服务进行设置
加载新编写的配置文件
sudo systemctl daemon-reload
将redis服务设为开机启动
sudo systemctl enable redis.service
启动redis服务
sudo systemctl start redis.service
查看服务状态
systemctl status redis.service
5.4 验证
使用redis-cli命令连接redis服务，-a参数后面填写指定密码
redis-cli -a 111111
然后使用keys * 查看所有的值如果出现(error) NOAUTH Authentication required.则表示密码输入错误。
Keys *

如果直接返回数据，或者返回为空则表示正常。
6.安装Apollo
6.1下载或上传
下载 - 进入到download文件夹，使用wget命令从官网下载Apollo
cd ~/download/
wget http://mirrors.tuna.tsinghua.edu.cn/apache/activemq/activemq-apollo/1.7.1/apache-apollo-1.7.1-unix-distro.tar.gz 
上传 - 上传apollo到download目录
在文档附带的package（Ctrl + 鼠标左键）目录中寻找apache-apollo-1.7.1-unix-distro.tar.gz
linux命令scp上传 - 请参见附件3 Ctrl + 鼠标左键进入超链接
windows上传 - 请参见附件2 Ctrl + 鼠标左键进入超链接
不管使用什么方式上传请将文件上传到~/download/目录
6.2 解压
使用tar命令对apache-apollo-1.7.1-unix-distro.tar.gz文件进行解压，解压到根目录soft文件夹
sudo tar -xf apache-apollo-1.7.1-unix-distro.tar.gz -C /soft/ 6.3配置
进入到/var/lib/下创建broker
cd /var/lib/
sudo /soft/apache-apollo-1.7.1/bin/apollo create birdnest

编写systemd配置文件 - 请查看附件4 Systemd操作 Ctrl + 鼠标左键进入超链接
在/etc/systemd/system/文件夹创建apollo.service文件，并将下面红色内容复制到文件中，vi或者vim命令的操作请查看附件5
[Unit]
Description=Apollo Service
After=network.target

[Service]
Type=simple
ExecStart=/var/lib/birdnest/bin/apollo-broker run
RestartSec=10

[Install]
WantedBy=multi-user.target
使用systemctl对apollo服务进行设置
加载新编写的配置文件
sudo systemctl daemon-reload
将apollo服务设为开机启动
sudo systemctl enable apollo.service
启动apollo服务
sudo systemctl start apollo.service
查看服务状态
systemctl status apollo.service
6.4 验证
打开浏览器输入http://IP:61680进入Apollo的Web Admin页面，输入默认账号密码，默认账号为admin密码为password


如果可以正常访问则表示安装成功

7.安装OpenSips
7.2安装依赖
编译所需依赖包
sudo apt-get install bison flex zlib1g-dev  libxml2-dev libxslt1-dev libncurses5-dev -y
MySQL依赖
sudo debconf-set-selections <<< 'mysql-server-5.7 mysql-server/root_password password root'
sudo debconf-set-selections <<< 'mysql-server-5.7 mysql-server/root_password_again password root'
apt-get install mysql-server-5.7 -y
apt-get install mysql-client-5.7 libmysqlclient-dev -y
7.2下载
进入到download文件夹，使用wget命令从官网下载Apollo
cd ~/download/
wget http://opensips.org/pub/opensips/2.3.0/opensips-2.3.0.tar.gz
7.3解压
使用tar命令对opensips-2.3.0.tar.gz文件进行解压，解压到根目录soft文件夹
sudo tar -xf opensips-2.3.0.tar.gz -C /soft/
7.	4配置
进入opensips目录，并编译代码
cd /soft/opensips-2.3.0
sudo make all
使用图形化内核编译软件menuconfig对opensips进行配置
sudo make menuconfig

选择Configure Compile Options --->Configure Excluded Modules ---> [*] db_mysql
选择Compile And Install OpenSIPS
选择Exit & Save All Changes
如果在执行完以上步骤后opensipsdbctl命令不能使用则需要配置环境变量使用
find /usr -name "opensipsdbctl"
例如：我使用sudo find /usr -name "opensipsdbctl"返回的信息如下
/usr/local/sbin/opensipsdbctl
将/usr/local/sbin/目录设置为环境量
export OPENSIPS=/usr/local/sbin/
export PATH=$PATH:$OPENSIPS
source /etc/profile
修改opensipsctlrc文件配置MySQL信息，vi或者vim命令的操作请查看附件5
vim /usr/local/etc/opensips/opensipsctlrc

使用opensipsdbctl create命令创建MySQL数据库，在输入命令并敲下回车后需要输入MySQL密码root密码
opensipsdbctl create
创建成功后则会显示

修改opensips.cfg中设置，修改listen的ip为本机的ip
vim opensips.cfg

编写systemd配置文件 - 请查看附件4 Systemd操作 Ctrl + 鼠标左键进入超链接
在/etc/systemd/system/文件夹创建opensips.service文件，并将下面红色内容复制到文件中。
[Unit]
Description=OpenSIPS Service
After=network.target

[Service]
Type=forking
ExecStart=/usr/local/sbin/opensipsctl start 
ExecReload=/usr/local/sbin/opensipsctl restart
ExecStop=/usr/local/sbin/opensipsctl stop
RestartSec=10

[Install]
WantedBy=multi-user.target

使用systemctl对opensips服务进行设置
加载新编写的配置文件
sudo systemctl daemon-reload
将opensips服务设为开机启动
sudo systemctl enable opensips.service
启动opensips服务
sudo systemctl start opensips.service
查看服务状态
systemctl status opensips.service
7.4 验证
添加SIP用户：
opensipsctl add <username> <password>
8.安装Nginx
8.1下载
进入到download文件夹，使用wget命令从官网下载Apollo
cd ~/download/
wget http://nginx.org/download/nginx-1.13.1.tar.gz
apt-get install libtool libpcre3 libpcre3-dev libpcre3 libpcre3-dev build-essential libtool zlib1g-dev openssl install build-essential
8.2解压
使用tar命令对opensips-2.3.0.tar.gz文件进行解压，解压到根目录soft文件夹
sudo tar -xf nginx-1.13.1.tar.gz -C /soft/
8.3配置
cd /soft/nginx-1.13.1/conf/
备份原有配置文件
mv nginx.conf nginx.conf.bak
编写nginx.conf配置文件，将附件1内容复制nginx.conf中
vim ngix.conf
编写systemd配置文件 - 请查看附件4 Systemd操作 Ctrl + 鼠标左键进入超链接
在/etc/systemd/system/文件夹创建nginx.service文件，并将下面红色内容复制到文件中，vi或者vim命令的操作请查看附件5。
[Unit]
Description=Nginx Service
After=network.target

[Service]
PIDFile=/usr/local/nginx/logs/nginx.pid
Type=simple
ExecStart=/usr/local/nginx/sbin/nginx -c /soft/nginx-1.13.1/conf/nginx.conf
ExecReload=/usr/local/nginx/sbin/nginx -s reload
ExecStop=/bin/kill -s QUIT $MAINPID
RestartSec=10
[Install]
WantedBy=multi-user.target
使用systemctl对nginx服务进行设置
加载新编写的配置文件
sudo systemctl daemon-reload
将nginx服务设为开机启动
sudo systemctl enable nginx.service
启动nginx服务
sudo systemctl start nginx.service
查看服务状态
sudo systemctl status nginx.service
8.4 验证
在浏览器中输入你配置好的域名，如果正常跳转，则表示配置成功
9安装NodeJs
9.1使用nvm安装nodejs
安装nvm
curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.29.0/install.sh | bash
查看可安装的nodejs版本
nvm ls-remote
安装指定版本
nvm install v6.10.0
设置默认版本
nvm alias default 6.10.0
如果安装了错误的版本
nvm uninstall 
9.2使用为nodejs安装cnpm命令
npm主要是为node管理项目所引用的包，由于npm的库存放在国外，虽然没有被中国的防火墙拦在墙外，但是由于地域跨度较大导致从国外服务器下载很慢，cnpm所指向的是国内服务器，与npm的功能一样，这样就解决下载速度慢甚至下载不下来的问题。
安装cnpm
sudo npm install -g cnpm --registry=http://r.cnpmjs.org
9.2安装forever
forever 是nodejs中的插件，在我们的项目中主要是使用forever启动项目而且会为启动的项目创建守护进程，保护应用的正常运行。
sudo npm install -g forever
10部署应用
这一节的主要任务是部署前后端应用，将前后端应用放到指定文件夹并运行，在Linux用户目录下创建boot目录，用来放需要部署的应用。
10.1准备工作
在用户根目录创建boot文件夹
cd ~
mkdir boot
上传应用包到服务器
Linux SCP命令上传 - 请查看附件3
Windows下使用Xftp5上传 - 请查看附件2
不管您所用的是那种方式，上传应用包请上传的download目录，这样每次上传的文件都会在download目录中，方便备份。
10.2 Birdnest
准备工作
将birdnest-api-booter-distribution.tar.gz解压到boot目录下
cd ~/download/
tar -xf birdnest-api-booter-distribution.tar.gz -C ~/boot/
执行run.sh Shell脚本，profile所指的是运行所指定的配置文件
cd ~/boot/birdnest-api-booter
sh run.sh <profile>
tailf nohup nohup.out
10.3 Garuda
配置环境变量
export DOMAIN_NAME="http://192.168.2.100:7000"
export NODE_ENV="test1"
export NATIVE_IP="192.168.2.100"
DOMAIN_NAME="http://ms.312.yjhcloud.cn/"
NODE_ENV="test"
NATIVE_IP="118.26.186.73"
准备工作，将bgaruda.tar.gz解压到boot目录下
cd ~/download/
tar -xf taruda.tar.gz -C ~/boot/
执行forever命令启动应用
cd ~/boot/taruda
forever start main.js
10.4 Wechat
准备工作，将wechat.tar.gz解压到boot目录下
cd ~/download/
tar -xf wechat.tar.gz -C ~/boot/
执行forever命令启动应用
cd ~/boot/wechat
forever start main.js

11服务号运维
11.1配置企业号
在完成一个服务号需要同时配置服务号，企业号以及管理平台。
管理平台 - 创建应用

输入科室信息点击保存




点击修改填写科室相关信息


至此，停留到该步骤，以下获取ID
企业号 - 创建应用
申请企业号并认证。
登陆企业微信公众平台-应用中心-新建应用-消息型应用

保存成功之后点击应用可看到如下信息

	至此，复制下应用ID回到管理平台填写对应字段
点击可信域名修改，填写服务器域名例如116.yjhcloud.com

其中etest.yjhcloud.com改成自己的域名，然后点击模式选择中的回调模式，进入以下页面






http://etest.yjhcloud.com/yjhcloud/wechat/cp/portal/81
回调接口只需要填写对应服务器域名，于对应科室ID

至此，复制下Token和AESKey回到管理平台填写对应字段


企业号 - 配置自定义菜单
再次点击回调模式 - 设置


点击 “加号”输入患者

点击4添加事件类型，选择跳转到网页

添加一级菜单名为：患者，然后点击右侧的添加事件类型选择跳转网页，在弹出的框中输入地址：
https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx7596c2f7fc245620&redirect_uri=http://mob.etest.yjhcloud.com/nurse&response_type=code&scope=snsapi_info&state=216#wechat_redirect
其中的appid换成现在企业号的corpId,”state=1192”中的1192换成现在的科室id.
添加一级菜单名为：我的，然后点击右侧的添加事件类型选择跳转网页，在弹出的框中输入地址：

https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx7596c2f7fc245620&redirect_uri=http://mob.etest.yjhcloud.com/nurse/center&response_type=code&scope=snsapi_info&state=216#wechat_redirect
其中的appid换成现在企业号的corpId,”state=1192”中的1192换成现在的科室id.
点击保存-发布。

企业号 - 创建部门
设置 - 普通管理组 - 新建

输入名称，管理员暂时不用输入，点击下一步

点击修改，进入设置应用权限并勾选应用，确定，保存

至此，复制CorpID，Secret回到管理平台填写对应字段



11.2配置服务号
打开浏览器登录微信公众平台-开发-基本配置，生成AppSecret。

复制AppID，AppSecret回到管理平台填写对应字段，
点击修改配置填写URL，Token（令牌），EncodingAESKey等

http://etest.yjhcloud.com/yjhcloud/wechat/portal/81
81是科室的ID，需要根据情况修改
复制Token回到管理平台填写对应字段

至此除了最后一个字段*服务号模板消息Id:没有填写，其余字段均已经填写上，点击保存。
服务号 - 配置服务号网页授权
公众号设置 - 功能设置 - 设置业务域名-设置js接口安全域名-设置网页授权域名，如图所示：

下载MP_verify_XXXXXXXXXXXXXXXXXXX.txt该文件上传到yjhcloud-weixin-node/build文件夹下

其中域名“etest.yjhcloud.com”换成自己的域名。端口




服务号 - 配置自定义菜单

登陆微信公众平台-进入自定义菜单-输入菜单名称（首页、我的）-页面地址选择跳转网页：

首页：https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx1c41754d919abf83&redirect_uri=http://mob.etest.yjhcloud.com/patient&response_type=code&scope=snsapi_userinfo&state=216#wechat_redirect

我的：
https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx1c41754d919abf83&redirect_uri=http://mob.etest.yjhcloud.com/patient/center&response_type=code&scope=snsapi_userinfo&state=216#wechat_redirect
其中这两个地址中的appid和http://mob.etest.yjhcloud.com换成自己的服务号appid和域名。“state=81”中的81是科室id,换成刚刚新建的科室id即可。
附件
附件1. Nginx配置文件
##   nginx.conf
worker_processes  2;
error_log  logs/error.log  info;
pid        logs/nginx.pid;
events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;
    client_max_body_size 8M;
client_body_buffer_size 128k;
# 请替换DOMAIN_NAME
    server {
        listen       80;
        server_name  ms.DOMAIN_NAME.cn;
        location / {
            proxy_pass http://127.0.0.1:7000/;
            proxy_connect_timeout 600;
            proxy_read_timeout 600;
            proxy_set_header  Host  $host;
            proxy_set_header  X-Real-IP  $remote_addr;
            proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;
        }

    }
# 请替换DOMAIN_NAME
    server {
        listen       80;
        server_name  wc.DOMAIN_NAME.cn;
        location / {
            proxy_pass http://127.0.0.1:8080/;
            proxy_connect_timeout 600;
            proxy_read_timeout 600;
            proxy_set_header  Host  $host;
            proxy_set_header  X-Real-IP  $remote_addr;
            proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;
        }
    }
# 请替换DOMAIN_NAME
    server {
        listen       80;
        server_name  DOMAIN_NAME.cn;
        location / {
            proxy_pass http://127.0.0.1:6020/;
            proxy_connect_timeout 600;
            proxy_read_timeout 600;
            proxy_set_header  Host  $host;
            proxy_set_header  X-Real-IP  $remote_addr;
            proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;
        }
    }
}
附件2. Windows下使用Xftp5上传
创建会话

输入用户名



输入密码



选择刚刚所创建的会话


现在就可以以拖拽的方式上传文件
附件3. Linux下使用scp命令上传
scp命令的功能是通过ssh远程复制<file>代表你要上传的文件，<user>代表远程服务器用户名，<ip>代表远程服务器的IP地址，<foler>表示你想要上传服务器的目标目录
scp <file> <user>@<ip>:<folder>
举例：
scp 是命令，birdnest-api-booter.jar是第一个参数也就是想要上传的文件，第二个参数nangle@192.168.3.12:~/download/中的nangle表示远程服务器的用户名，@是分隔符，192.168.3.12表示远程服务器的IP，：冒号区分IP与文件夹目录，~/download/这一段中，～波浪号表示Linux系统用户目录(如果不理解请搜索”linux ~目录”)，download是用户目录下的download文件夹。
scp birdnest-api-booter.jar nangle@192.168.3.12:~/download/
附件4. Systemd服务相关操作
进入到system文件夹对应用的服务文件进行配置
cd etc/systemd/system

这里是蜂鸟护理涉及的所有服务配置文件
需要更改替换对应的.service配置文件中的绝对路径，以保证软件的正确运行。
vim xxx.service
重新加载服务
systemctl daemon-reload
启动服务
systemctl start xxx.service
开机启动服务
systemctl enable xxx.service
查看服务状态，
systemctl status xxx.service
当使用查看服务状态命令后Loaded属性等于loaded ，Active属性等于active（running）则表示这个服务已经成功启动。

请按照文档中的要求一步步走，会少碰到很多问题。

附件5. vi和vim命令的使用
警告：对各种文件的修改必须提前备份备份格式 file-name.bak，这是一个良好的习惯，也许你会感谢我。
简介
在windows环境下编辑文本文件有图形界面帮忙，但是在linux命令行的环境下如果想编辑文本文件就不那么容易了，我们需要借助vi或者vim命令的帮助，vi是linux系统中原生自带的命令，vim则需要手动下载，我们则可以理解vim是vi的扩展比vi更强大，如果只是简单操作是看不出什么不同的，如果想详细了解自行百度。

如何使用
举例：
vi /path/to/file
先打开一个文件
vi /etc/hosts
我们看到的这张图红色部分直到波浪线（~）这些都是这个文件的主要内容。

编辑文件：在当前这个状态下输入小写的i编辑这个文件，下面这个-- INSERT -- 表示这个文件已经是插入状态，可以在光标处输入了。

退出编辑状态：当你修改完文件以后，可以使用ESC键来退出编辑状态，可以看见下面这个-- INSERT -- 已经不见了。

不保存退出：如果你不想对你的修改进行保存请输入“:q!”冒号q非，q是退出的意思，感叹号在逻辑运算中表示非则是不保存退出。

保存退出：如果您已经对你的文件编辑文件，可以输入“:wq”,w可以理解为write to disk（写入磁盘）。
总结
如果仅限于简单的修改文件以上这几个操作已经足够，如果还有更深入的需求，请自行google Baidu。
再次提醒，谨慎修改文件，提前做好备份。
